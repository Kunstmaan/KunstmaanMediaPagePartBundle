{% block media_widget %}
{% spaceless %}
	<div id="{{ id }}_widget">
		<input type="hidden" name="{{ full_name }}" value="{% if(value.id is defined) %}{{ value.id }}{% endif %}"/>
		
		
		<div class="input_media hasnomedia">
			<div class="preview"></div>
			<button data-toggle="modal" data-target="#Media_Chooser" class="choose">Choose File</button>
		</div>
		
		<div class="input_media hasmedia">
			<div class="preview">
				{% if(value.ent is defined) %}
					{% include 'KunstmaanMediaBundle:'~value.ent.classtype~':widgetview.html.twig' with {'media': value.ent} %}
				{% else %}
					<img src="" alt="" />
				{% endif %}
			</div>
			<button class="del">Delete File</button>
			<p class="title"></p>
		</div>
	</div>






	<script type="text/javascript">
		{
			var widget = jQuery('#{{ id }}_widget');
			if ( widget.find('input').val() == '') {
				widget.find('.hasnomedia').show();
				widget.find('.hasmedia').hide();
			} else {
				widget.find('.hasnomedia').hide();
				widget.find('.hasmedia').show();
			}
			widget.find('.choose').on('click', function(ev) {
				ev.preventDefault();
				openDGDialog('{{ path(pattern) }}', 800, 600, function(param){
					var widget = jQuery('#{{ id }}_widget');
					widget.find('input').val(dialogWin.returnedValue.id);
					if(typeof(dialogWin.returnedValue.title)!="undefined"){
						widget.find('.hasmedia').find('.title').html(dialogWin.returnedValue.title);
						widget.find('.hasmedia').find('.title').show();
					} else {
						widget.find('.hasmedia').find('.title').hide();
					}
					if(typeof(dialogWin.returnedValue.imgpath)!="undefined"){
						widget.find('.hasmedia').find('img').attr('src', dialogWin.returnedValue.imgpath);
						widget.find('.hasmedia').find('img').show();
					} else {
						widget.find('.hasmedia').find('img').hide();
					}
					widget.find('.hasnomedia').hide();
					widget.find('.hasmedia').show();
				});
			});
			widget.find('.del').on('click', function(ev) {
				ev.preventDefault();
				var widget = jQuery('#{{ id }}_widget');
				widget.find('input').val('');
				widget.find('.hasnomedia').show();
				widget.find('.hasmedia').hide();
			});
		}
	</script>
{% endspaceless %}
{% endblock %}
